<!-- Add to Cart Modal -->

<!-- Success Animation -->
<div class="cart-success-animation" id="cartSuccessAnimation">
    <div class="cart-success-content">
        <div class="cart-success-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 12l2 2 4-4"></path>
                <circle cx="12" cy="12" r="10"></circle>
            </svg>
        </div>
        <div class="cart-success-message">Product Successfully Added to Cart</div>
    </div>
</div>

     Modal overlay 
    <div class="cart-modal-overlay" id="cartModalOverlay" onclick="closeCartModal(event)">
        <div class="cart-modal" onclick="event.stopPropagation()">
            <!-- Modal header -->
            <div class="cart-modal-header">
                <div class="cart-modal-title">
                    <svg class="cart-bag-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 2l3 6v8a2 2 0 002 2h2a2 2 0 002-2V8l3-6"/>
                        <path d="M5 8h14l-1 13H6L5 8z"/>
                        <path d="M10 10v4"/>
                        <path d="M14 10v4"/>
                    </svg>
                    You've Got Great Taste
                    <span class="cart-item-count">1 Item</span>
                </div>
                <button class="cart-close-button" onclick="closeCartModal()">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="cart-modal-body">
                <div class="cart-modal-content-wrapper">
                    <!-- Left side - Product section -->
                    <div class="cart-left-section">
                        <div class="cart-product-section">
                            <div class="cart-product-image">
                                <img src="{{ url_for('static', filename='images/Tube Tops.png') }}" alt="{{ product_name }}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                            </div>
                            <div class="cart-product-details">
                                <div class="cart-product-name">{{ product_name }}</div>
                                <div class="cart-product-color">Color: <span id="cartModalSelectedColor">{{ selected_color|default('Black') }}</span></div>
                                <div class="cart-product-size">Size: <span id="cartModalSelectedSize">{{ selected_size }}</span></div>
                                <div class="cart-product-quantity">Quantity: <span id="cartModalSelectedQuantity">{{ selected_quantity|default('1') }}</span></div>
                                <div class="cart-product-price">${{ "%.2f"|format(product_price) }} USD</div>
                            </div>
                        </div>
                    </div>

                    <!-- Right side - Subtotal and actions -->
                    <div class="cart-right-section">
                        <div class="cart-subtotal-section">
                            <div class="cart-subtotal-label">Subtotal</div>
                            <div class="cart-subtotal-amount">${{ "%.2f"|format(product_price) }} USD</div>
                        </div>

                        <div class="cart-action-buttons">
                            <button class="cart-checkout-button">VIEW BAG & CHECKOUT</button>
                            <a href="#" class="cart-continue-shopping" onclick="closeCartModal()">
                                Continue Shopping
                                <svg class="cart-arrow-icon" viewBox="0 0 24 24">
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                    <polyline points="12,5 19,12 12,19"></polyline>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Recommendations section -->
                <div class="cart-recommendations">
                    <h3 class="cart-recommendations-title">Goes well with</h3>
                    <div class="cart-recommendations-grid">
                        <div class="cart-recommendation-item">
                            <div class="cart-recommendation-image">Clippable Nano Pouch</div>
                            <div class="cart-recommendation-name">Clippable Nano Pouch</div>
                            <div class="cart-recommendation-price">$24 USD</div>
                        </div>
                        <div class="cart-recommendation-item">
                            <div class="cart-recommendation-image">New Crew Backpack</div>
                            <div class="cart-recommendation-name">New Crew Backpack 22L Updated</div>
                            <div class="cart-recommendation-price">$98 USD</div>
                        </div>
                        <div class="cart-recommendation-item">
                            <div class="cart-recommendation-image">Everywhere Backpack</div>
                            <div class="cart-recommendation-name">Everywhere Backpack 22L Metal Hardware</div>
                            <div class="cart-recommendation-price">$98 USD</div>
                        </div>
                        <div class="cart-recommendation-item">
                            <div class="cart-recommendation-image">City Essentials Pouch</div>
                            <div class="cart-recommendation-name">City Essentials Pouch Mini 2L</div>
                            <div class="cart-recommendation-price">$38 USD</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
        function showCartSuccessAnimation() {
            const successAnimation = document.getElementById('cartSuccessAnimation');
            successAnimation.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Hide success animation after 2 seconds and show modal
            setTimeout(() => {
                successAnimation.classList.remove('active');
                // Show the modal after success animation
                setTimeout(() => {
                    openCartModal();
                }, 300);
            }, 2000);
        }

        function openCartModal() {
            const modal = document.getElementById('cartModalOverlay');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeCartModal(event) {
            // Only close if clicking the overlay or close button
            if (event && event.target !== event.currentTarget && !event.target.classList.contains('cart-close-button')) {
                return;
            }
            
            const modal = document.getElementById('cartModalOverlay');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const successAnimation = document.getElementById('cartSuccessAnimation');
                const modal = document.getElementById('cartModalOverlay');
                
                // Close success animation if active
                if (successAnimation.classList.contains('active')) {
                    successAnimation.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
                // Close modal if active
                else if (modal.classList.contains('active')) {
                    closeCartModal();
                }
            }
        });

        // Prevent modal from closing when clicking inside the modal content
        document.querySelector('.cart-modal').addEventListener('click', function(event) {
            event.stopPropagation();
        });

        // Handle clicking outside success animation
        document.getElementById('cartSuccessAnimation').addEventListener('click', function(event) {
            if (event.target === this) {
                this.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });

        // Prevent success content from closing when clicked
        document.querySelector('.cart-success-content').addEventListener('click', function(event) {
            event.stopPropagation();
        });
</script>