<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Payment</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/payment.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/_header.css') }}">
</head>
<body>
    <!-- Header -->
    {% include 'partials/_header.html' %}
    
    <div class="container">
        <h1 class="page-title">Checkout</h1>
        
        <div class="checkout-layout">
             Left Column - Checkout Information 
            <div class="checkout-info">
                 Notifications Section 
                <div class="info-section">
                    <div class="section-header">
                        <div class="check-icon">‚úì</div>
                        <h3>Notifications to</h3>
                    </div>
                    <div class="section-content">
                        <span class="email">{{ user.email if user and user.email else 'user@example.com' }}</span>
                        <button class="edit-btn">Edit</button>
                    </div>
                </div>

                 Shipping Address Section 
                <div class="info-section">
                    <div class="section-header">
                        <div class="check-icon">‚úì</div>
                        <h3>Sending to</h3>
                    </div>
                    <div class="section-content">
                        <div class="address-info">
                            <div class="address-line">{{ shipping_address.name if shipping_address else 'John Doe' }}</div>
                            <div class="address-line">{{ shipping_address.address if shipping_address else '123 Main Street' }}</div>
                            <div class="address-line">{{ shipping_address.city if shipping_address else 'City' }}, {{ shipping_address.state if shipping_address else 'State' }} {{ shipping_address.zip_code if shipping_address else '12345' }}, {{ shipping_address.country if shipping_address else 'USA' }}</div>
                            <div class="address-line">{{ shipping_address.phone if shipping_address else '(555) 123-4567' }}</div>
                        </div>
                        <button class="edit-btn">Edit</button>
                    </div>
                </div>

                 Delivery Section 
                <div class="info-section">
                    <div class="section-header">
                        <div class="check-icon">‚úì</div>
                        <h3>Estimated delivery</h3>
                    </div>
                    <div class="section-content">
                        <div class="delivery-info">
                            <span class="delivery-icon">üì¶</span>
                            <span class="delivery-text">Mon, Sep 23 (FREE)</span>
                        </div>
                        <button class="edit-btn">Edit</button>
                    </div>
                </div>

                 Payment Method Section 
                <div class="payment-section">
                    <h3 class="payment-title">Payment method</h3>
                    
                     Gift Card Option 
                    <div class="payment-option gift-card">
                        <span class="gift-icon">üéÅ</span>
                        <span>Use my gift card</span>
                        <button class="add-btn">+ Add a discount/gift card</button>
                    </div>

                     Payment Methods 
                    <div class="payment-methods">
                         PayPal 
                        <div class="payment-method" data-method="paypal">
                            <div class="method-header">
                                <div class="method-info">
                                    <img src="/placeholder.svg?height=20&width=60" alt="PayPal" class="payment-logo">
                                    <span>Pay with PayPal</span>
                                </div>
                                <button class="expand-btn">+</button>
                            </div>
                        </div>

                         Afterpay 
                        <div class="payment-method" data-method="afterpay">
                            <div class="method-header">
                                <div class="method-info">
                                    <div class="afterpay-logo">$</div>
                                    <div>
                                        <span>Pay with Afterpay</span>
                                        <div class="method-subtitle">Pay in 4 interest-free payments</div>
                                    </div>
                                </div>
                                <button class="expand-btn">+</button>
                            </div>
                        </div>

                         Klarna 
                        <div class="payment-method" data-method="klarna">
                            <div class="method-header">
                                <div class="method-info">
                                    <div class="klarna-logo">klarna</div>
                                    <div>
                                        <span>Pay with Klarna</span>
                                        <div class="method-subtitle">Pay in 4 interest-free payments</div>
                                    </div>
                                </div>
                                <button class="expand-btn">+</button>
                            </div>
                        </div>

                         Credit Card 
                        <div class="payment-method active" data-method="credit-card">
                            <div class="method-header">
                                <div class="method-info">
                                    <div class="card-icons">
                                        <span class="card-icon">üí≥</span>
                                    </div>
                                    <span>Pay with credit card</span>
                                </div>
                                <button class="expand-btn">‚àí</button>
                            </div>
                            
                            <div class="method-content">
                                <form class="credit-card-form">
                                    <div class="form-group">
                                        <label for="card-number">Credit card number</label>
                                        <div class="card-input-wrapper">
                                            <input type="text" id="card-number" placeholder="1234 5678 9012 3456" maxlength="19">
                                            <div class="card-types">
                                                <img src="/placeholder.svg?height=20&width=30" alt="Visa">
                                                <img src="/placeholder.svg?height=20&width=30" alt="Mastercard">
                                                <img src="/placeholder.svg?height=20&width=30" alt="Amex">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="expiry">Expiry (MM / YY)</label>
                                            <input type="text" id="expiry" placeholder="MM / YY" maxlength="7">
                                        </div>
                                        <div class="form-group">
                                            <label for="security-code">Security code <span class="info-icon">‚ìò</span></label>
                                            <input type="text" id="security-code" placeholder="123" maxlength="4">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="card-name">Name on card</label>
                                        <input type="text" id="card-name" placeholder="John Doe">
                                    </div>

                                    <div class="billing-section">
                                        <h4>Billing address</h4>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="same-address" checked>
                                            <label for="same-address">Same as shipping address</label>
                                        </div>
                                        
                                        <div class="billing-address">
                                            <div class="address-line">{{ shipping_address.name if shipping_address else 'John Doe' }}</div>
                                            <div class="address-line">{{ shipping_address.address if shipping_address else '123 Main Street' }}</div>
                                            <div class="address-line">{{ shipping_address.city if shipping_address else 'City' }}, {{ shipping_address.state if shipping_address else 'State' }} {{ shipping_address.zip_code if shipping_address else '12345' }}, {{ shipping_address.country if shipping_address else 'USA' }}</div>
                                        </div>

                                        <div class="checkbox-group">
                                            <input type="checkbox" id="save-card">
                                            <label for="save-card">Save card to my account</label>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

             Right Column - Order Summary 
            <div class="order-summary">
                <h3>Order summary</h3>
                <div class="item-count">üì¶ {{ cart_items|length if cart_items else 1 }} item{{ 's' if cart_items|length > 1 else '' }} ‚Ä¢ ${{ "%.2f"|format(subtotal|default(47.00)) }}</div>
                
                {% if cart_items %}
                    {% for item in cart_items %}
                    <div class="product-item">
                        <img src="{{ item.image_url if item.image_url else url_for('static', filename='images/product_1.jpg') }}" alt="{{ item.name }}" class="product-image">
                        <div class="product-details">
                            <h4>{{ item.name }}</h4>
                            <div class="product-variant">{{ item.variant if item.variant else 'Standard' }}</div>
                            <div class="product-size">Size: {{ item.size if item.size else 'ONE SIZE' }}</div>
                            <div class="product-quantity">Quantity: {{ item.quantity }}</div>
                        </div>
                        <div class="product-price">${{ "%.2f"|format(item.price * item.quantity) }}</div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="product-item">
                        <img src="{{ url_for('static', filename='images/product_1.jpg') }}" alt="Product" class="product-image">
                        <div class="product-details">
                            <h4>Back to Life Sport Bottle 20oz</h4>
                            <div class="product-variant">"Stripe Lid"</div>
                            <div class="product-size">Size: ONE SIZE</div>
                            <div class="product-quantity">Quantity: 1</div>
                        </div>
                        <div class="product-price">$44.00</div>
                    </div>
                {% endif %}

                <div class="order-totals">
                    <div class="total-line">
                        <span>Subtotal</span>
                        <span>${{ "%.2f"|format(subtotal|default(44.00)) }}</span>
                    </div>
                    <div class="total-line">
                        <span>Shipping</span>
                        <span>{% if delivery_fee and delivery_fee > 0 %} 
                                ${{ "%.2f"|format(delivery_fee) }}
                              {% else %}
                                FREE
                              {% endif %}</span>
                    </div>
                    <div class="total-line">
                        <span>Tax</span>
                        <span>${{ "%.2f"|format(tax|default(3.96)) }}</span>
                    </div>
                    {% if discount and discount > 0 %}
                    <div class="total-line">
                        <span>Discount</span>
                        <span style="color: #dc3545;">-${{ "%.2f"|format(discount) }}</span>
                    </div>
                    {% endif %}
                    <div class="total-line final-total">
                        <span>Order total</span>
                        <span>USD ${{ "%.2f"|format(total|default(47.96)) }}</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="checkout-actions">
            <button class="review-order-btn">COMPLETE ORDER</button>
            <div class="powered-by">Secure checkout powered by SHOP.CO</div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/payment.js') }}"></script>
</body>
</html>